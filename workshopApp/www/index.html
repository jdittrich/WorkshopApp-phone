<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <title>DesignStudio</title>
    
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    
    <!--    <link rel="stylesheet"  href="jquery.mobile-1.4.0-rc.1.min.css">-->
    <link rel="stylesheet" href="css/jquery.mobile-1.3.2.min.css">
    <link rel="stylesheet" href="css/flipclock.css">
    <script src="js/libs/jquery2.min.js"></script>
    <!--  <script src="jquery.mobile-1.4.0-rc1.js"></script>-->
    <script src="js/libs/jquery.mobile-1.3.2.js"></script>
    <script src="js/libs/base.js"></script><!-- needed for flipclock--> 
    <script src="js/libs/flipclock.min.js"></script>
    <script src="js/libs/handlebars.js"></script>
    <script src="js/jansCode.js"></script>
    <script id="template-data" type="application/json">
        {
          "title": "My Workshop Title",
          "participants": 5,
          "Tasks": [
            {
              "id": "firstTask",
              "title": "first Task",
              "designTask": "Do something pretty!",
              "durationMinutes": 5,
              "presentTask": "Show your Design",
              "reviewTask": "Use paper and pencils"
            },
            {
              "id": "anotherTask",
              "title": "Another Task",
              "designTask": "Do something very pretty!",
              "durationMinutes": 5,
              "presentTask": "Show your iterated Design",
              "reviewTask": "Use more paper and pencils"
            }
          ]
        }
    </script>
    <script id="template" type="text/x-handlebars-template">
        <div data-role="page" id="overview">
            <div data-role="header">
                 <h1>{{title}}</h1>
            </div><!-- /header -->
            <div data-role="content">
                <ul>
              {{#Tasks}}
              <!-- loop all [Tasks] -->
                <li><a href="#presentReview-{{id}}">{{title}}</a></li>
              {{/Tasks}}
              {{^Tasks}}
                <!-- if no tasks are found -->
                <li>No Tasks found!</li>
              {{/Tasks}}
              </ul>
            </div><!-- /content -->
        </div><!--End page -->

        {{#Tasks}}
        <div data-role="page" id="design-{{id}}">
          <div data-role="header" data-id="dr-{{id}}" data-position="fixed">
            <h1>Design!</h1>
            <div data-role="navbar">
                <ul>
                <li><a href="#design-{{id}}" class="ui-btn-active ui-state-persist">Design</a></li>
                <li><a href="#presentReview-{{id}}" >Review</a></li>
                </ul>
            </div><!-- /navbar -->
          </div><!-- /header -->
          <div data-role="content">
            <p>{{designTask}}</p>
          </div><!-- /content -->
        </div><!--End page -->
          
        <div data-role="page" id="presentReview-{{id}}">
          <div data-role="header" data-id="dr-{{id}}" data-position="fixed">
           <h1>Present and Review</h1>
             <div data-role="navbar">
                <ul>
                <li><a href="#design-{{id}}">Design</a></li>
                <li><a href="#presentReview-{{id}}" class="ui-btn-active ui-state-persist">Review</a></li>
                </ul>
            </div><!-- /navbar -->
          </div><!-- /header -->
        
          <div data-role="content">
              <div data-role="collapsible" >
                  <button href="#" data-role="button" data-inline="true">Cancel</button>
                  <h3>Present </h3>
                  <p>{{presentTask}}</p>
              </div>
              
              <div data-role="collapsible" >
                  <h3>Review <button href="#" data-role="button" data-inline="true"> Cancel</button></h3>
                  <p>{{reviewTask}}</p>
              </div>
          </div><!-- /content -->
          
        </div><!--End page -->
        {{/Tasks}}
    </script>
    <script>
    $(function(){
        (function(){
            var data = $.parseJSON( $("#template-data").html());
            var template = $("#template").html();
            console.log("heho");
            var compiledTemplate = Handlebars.compile(template);        
            $("#placeholder").replaceWith(compiledTemplate(data)); //replace with is used because I dont get DOMFragements to work and I dont want to replace the whole content
            $("#container").trigger("create"); //triggers the enhancement of inserted HTML
        }())
    });
    </script>
</head>

<body>
    
    <div id="container">
    <div data-role="page" id="overview">
        <div data-role="header">
            <h1>My Title</h1>
        </div>
        <!-- /header -->
        <div data-role="content">
            <button id="startButton">insert stuff!</button>
            <a href="#design">go now!</a>
        </div>
        <!-- /content -->
    </div>
    <div id="placeholder">
    </div>
    <!--End page -->
</div><!-- end container-->
<script type="text/javascript">
            app.initialize();
</script>

</body>

</html>